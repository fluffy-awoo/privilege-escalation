#!/bin/bash

rm /challenge/.init
find -L /challenge -type f -exec chmod 0444 {} +

cargo build --release --manifest-path=/challenge/Cargo.toml --target-dir=/challenge
mv /challenge/release/astral /challenge/astral
mv /challenge/src/main.rs /challenge/astral.rs
rm -rf /challenge/Cargo.* /challenge/src /challenge/release

chmod 4555 /challenge/astral
chmod u+s /usr/bin/su